name: Ansible Galaxy

on:
  release:
    types:
      - published

jobs:
  deploy:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v1
    - name: Set up Python 3
      uses: actions/setup-python@v1
      with:
        python-version: 3.6
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        # We need the pre-release version of Ansible to use the 'collection' action in ansible-galaxy.
        # Remove '--pre' once Ansible 2.9 is released.
        pip install --pre ansible

    - name: Report Ansible version
      run: ansible --version

    - name: Build the collection
      run: ansible-galaxy collection build

    # - name: Deploy the collection
    #   run: ansible-galaxy collection publish ./artis3n.github_version-*.tar.gz --api-key=${{ secrets.GALAXY_API_KEY }}
    #   if: success()
